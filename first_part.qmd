---
title: "Description of the data sets"
format: html
editor: visual
---

# Preparation

```{r}
#| message: FALSE
here::i_am("project_datamanagement.Rproj")
library(here)
library(vroom) 
library(dplyr)
library(tidyr)
library(ggplot2)
```

# Links

## Link to the github project

<https://github.com/inesdamiche/project_datamanagement.git>

## Links to the sources

### For the World Bank Database

We got the data by generating it through the World Bank Database by selecting all the countries , 2021 for the year and our variables of interest (Percentage of Women in Parliament , Female Labour Participation and Labour Participation, Annual GDP growth ) and by clicking on "Download options": <https://databank.worldbank.org/source/world-development-indicators>

We did the same thing for the meta-data (to categorise the countries by income group and regions): <https://databank.worldbank.org/source/world-development-indicators>

### For the Human Development Composite Indices

<https://hdr.undp.org/data-center/documentation-and-downloads> We selected : "Human development Index and components" " Inequality-adjusted Human Development Index" "Gender development Index" "Planetary Pressure-adjusted HDI"

The meta-data for these databases is taken from the UN's Statistics Division website : we downloaded the CSV version <https://unstats.un.org/unsd/methodology/m49/overview/>

# Short description of the sources

## World Development Indicators

The World Development Indicators are compiled by the **World Bank**. There are "a compilation of relevant, high quality, and internationally comparable statistics about global development and the fight against poverty".

### Indicator: Proportion of seats held by women in national parliaments (%)

The data is compiled by the **Inter-Parliamentary Union (IPU)** (<https://ipu.org/>) based on information provided by National Parliaments. The data is compiled every year.

### Indicator: Women Business and the Law Index Score (scale 1-100)

The data is compiled every year by the **World Bank** (<https://wbl.worldbank.org/>).

### Indicator: Military expenditure (% of GDP)

The data is compiled every year by the **Stockholm International Peace Research Institute (SIPRI)** (<https://www.sipri.org/databases>).

Because of the differences in definitions and the difficulty in verifying the accuracy and completeness of data, data on military expenditures are not always comparable across countries. However, SIPRI puts a high priority on ensuring that the data series for each country is comparable over time.

### Indicator: Labor force participation rate, total (% of total population ages 15+) (modeled ILO estimate)

The data is compiled by the **International Labor Organization** (<https://ilostat.ilo.org/data/>) from labor force surveys, censuses, and establishment censuses and surveys. It is part of the "ILO modeled estimates database". The data is compiled every year.

### Indicator: Labor force participation rate, female (% of female population ages 15-64) (modeled ILO estimate)

The data is compiled in the same way as for the previous indicator.

### Indicator: GDP growth (annual %)

The data come from **the World Bank** national accounts data and **OECD** National Accounts files. It is compiled every year.

## Human Development Indices

The Human Development Indices are compiled by the **UNDP** (<https://www.undp.org>). The Human Development Indices are "a measure of average achievement in key dimensions of human development".

### Indicator: planetary pressures-adjusted Human Development Index (HDI, PHDI, adjustment factor for planetary pressures, Carbon dioxide emissions per capita (production), Carbon dioxide emissions (production) index, Material footprint per capita, Material footprint index)

From this dataset compiled by the **UNDP**, we chose to only use the indicator "Planetary pressures-adjusted HDI (PHDI)" because we think it is the more relevant and concise one. The PHDI is compiled by the UNDP. The PHDI is computed as the product of the HDI and the "adjustment factor for planetary pressures". This factor is computed thanks to the **United Nations Environment Programme (2022)** and the **Global Carbon Project (2022)**.

### Indicator: Human development index and its components (HDI, Life expectancy at birth, expected years of schooling, mean years of schooling, gross national income per capita, GNI per capita rank minus HDI rank, HDI rank)

From this dataset compiled by the **UNDP**, we chose to use the indicator "HDI" because we think it is the more relevant and concise one. To compute the HDI, the PNUD uses different indicators:

-   Life expectancy at birth: **UNDESA (2022)**

-   Expected years of schooling: **UNESCO Institute for Statistics (2022), ICF Macro Demographic and Health Surveys, United Nations Children's Fund (UNICEF) Multiple Indicator Cluster Surveys and OECD (2022)**

-   Mean years of schooling: **UNESCO Institute for Statistics (2022), Barro and Lee (2018), ICF Macro Demographic and Health Surveys, UNICEF Multiple Indicator Cluster Surveys and OECD (2022)**

-   GNI per capita: **World Bank (2022), IMF (2022) and United Nations Statistics Division (2022)**

### Indicator: Gender development index

From this dataset, we chose to only use the indicator "GDI" because we think it is the more relevant and concise one. GDI is computed thanks to different indicators:

-   Life expectancy at birth: **UNDESA (2022)**

-   Expected years of schooling: **UNESCO Institute for Statistics (2022), ICF Macro Demographic and Health Surveys, United Nations Children's Fund (UNICEF) Multiple Indicator Cluster Surveys and OECD (2022)**

-   Mean years of schooling for adults ages 25 andcolder: **UNESCO Institute for Statistics (2022), Barro and Lee (2018), ICF Macro Demographic and Health Surveys, UNICEF's Multiple Indicator, Cluster Surveys and OECD (2022)**

-   Estimated earned income: **Human Development Report Office estimates based on female and male shares of the economically active population, the ratio of the female to male wage in all sectors and gross national income in 2017 purchasing power parity (PPP) terms, and female and male shares of population from ILO (2022), UNDESA (2019), World Bank (2022), United Nations Statistics Division (2022) and IMF (2022)**

### Indicator: Inequality-adjusted Human Development Index (Coefficient of human inequality, Inequality in life expectancy, Inequality-adjusted life expectancy index, Inequality in education, Inequality-adjusted education index, Inequality in income, Inequality-adjusted income index, Income shares held by (%), Gini coefficient)

From this dataset, we chose to only use the indicator "Gini coefficient" because we think it is the more relevant and concise one. The Gini coefficient comes from the **World Inequality Database (2022)** (<https://wid.world>).

# Tables with basic information

## Loading the datasets

```{r}
metadata <- vroom(here("data csv/countries_metadata.csv")) 
gender_dev <- vroom(here("data csv/dvlpmt_gender_index.csv"))
planet_HDI <- vroom(here("data csv/HDI_planet.csv"))
HDI <- vroom(here("data csv/HDI.csv"))
inequalities <- vroom(here("data csv/inequalities.csv"))
world_dev <- vroom(here("data csv/World Development Indicators - WB.csv"))
metadata_UNDP <- vroom(here("data csv/UNSD â€” Methodology.csv")) 
```

## Tables (before cleaning and joining)

```{r}
metadata |> 
  summarise("nb of rows in metadata" = nrow(metadata), "nb of columns in metadata"   = ncol(metadata))|>
  knitr::kable() 

metadata_UNDP |> 
  summarise("nb of rows in metadata UNDP" = nrow(metadata_UNDP), "nb of columns in metadata UNDP"   = ncol(metadata_UNDP))|>
  knitr::kable() 

gender_dev |> 
  summarise("nb of rows in gender_dev" = nrow(gender_dev), "nb of columns in metadata"   = ncol(gender_dev))|>
  knitr::kable()

HDI |> 
  summarise("nb of rows in HDI" = nrow(HDI), "nb of columns in HDI"   = ncol(HDI))|>
  knitr::kable()

inequalities |> 
  summarise("nb of rows in inequalities" = nrow(inequalities), "nb of columns in inequalities" = ncol(inequalities))|>
  knitr::kable()

planet_HDI |> 
  summarise("nb of rows in planet_HDI" = nrow(planet_HDI), "nb of columns in planet_HDI" = ncol(planet_HDI))|>
  knitr::kable()

world_dev |> 
  summarise("nb of rows in world_dev " = nrow(world_dev), "nb of columns in world_dev" = ncol(world_dev))|>
  knitr::kable()

```

# Short description of each variable

# Description of the data joining, cleaning, etc

```{r}
# Data Cleaning - World Development Indicators.
# We turn the rows that do not contains a values into NA value
Dev <- world_dev |>
  mutate(`2021 [YR2021]` = na_if(`2021 [YR2021]`, ",,"))
# We turn the values into numeric ones and make sure that Rstudio takes into account that the decimal separator is "," and not "."
Dev <- Dev|>
  mutate(`2021 [YR2021]` = as.numeric(gsub(",",".", `2021 [YR2021]`)))
```

```{r}
# UNDP Database
#we select columns we are interested in and turn the values into numeric ones 
HDI<-
  HDI|>
  select(`Table 1. Human Development Index and its components`,...3)|>
  rename(`Country Name`=`Table 1. Human Development Index and its components`,HDI_val=...3)
HDI <- HDI|>
  mutate(HDI_val = as.numeric(gsub(",", ".", HDI_val)))

#Gender Development Index
GDI<-gender_dev|>
  select(`Table 4. Gender Development Index`,...3)|>
  rename(`Country Name`=`Table 4. Gender Development Index`,GDI_val=...3)|>
   mutate(GDI_val = as.numeric(gsub(",", ".", GDI_val)))

# Gini Coefficient
Gini<-inequalities|>
  select(`Table 3. Inequality-adjusted Human Development Index`,...31)|>
  rename(`Country Name`=`Table 3. Inequality-adjusted Human Development Index`,Gini_coef=...31)|>
  mutate(Gini_coef = as.numeric(gsub(",", ".", Gini_coef)))

#PHDI
PHDI<-planet_HDI|>
  select(`Table 7. Planetary pressures-adjusted Human Development Index`,...5)|>
  rename(`Country Name`=`Table 7. Planetary pressures-adjusted Human Development Index`,PHDI=...5)|>
  mutate(PHDI = as.numeric(gsub(",", ".", PHDI)))

```

```{r}
# Metadata cleaning 
#World Bank
meta_WB<-metadata|>
  select(Code,`Table Name`,Region,`Income Group`)|>
  rename(`Country Name`=`Table Name`)
#UNDP
meta_UNDP<-metadata_UNDP|>
  select(`Country or Area`,`ISO-alpha3 Code`)|>
  rename(`Country Name`=`Country or Area`)
```

```{r}
#MetaData Joining - UNDP databases
#join UNDP data with their Country Code

# Function in order to perform a "left-join" for each databases
country_code<-function(dataset1,dataset2){
  dataset1<-left_join(dataset1, dataset2, join_by(`Country Name`))|>
    rename(`Country Code`=`ISO-alpha3 Code`)|>
    drop_na(`Country Code`)|>
    select(-`Country Name`)
  
}

# we create a new metadata dataframe to join the country code for the 12 countries that couldn't be joined

other <- tibble(`Country Name`  = c("United States", "United Kingdom", "Tanzania (United Republic of)", "Palestine, State of", "Netherlands","Moldova (Republic of)",	"Korea (Republic of)" , "Korea (Democratic People's Rep. of)" , "Hong Kong, China (SAR)",
"Eswatini (Kingdom of)" , "CÃ´te d'Ivoire" , "Congo (Democratic Republic of the)"),
  `ISO-alpha3 Code` = c("USA","GBR","TZA","PSE","NLD", "MDA","KOR","PRK","HKG","SWZ","CIV","COD"))
meta_UNDP<-rbind(meta_UNDP,other)


HDI<-country_code(HDI,meta_UNDP)
GDI<-country_code(GDI,meta_UNDP)
Gini<-country_code(Gini,meta_UNDP)
PHDI<-country_code(PHDI,meta_UNDP)
```

```{r}
#MetaData Joining - WB databases
meta_WB<-meta_WB|>
  select(-`Country Name`)|>
  rename(`Country Code`=`Code`)
Dev<-left_join(Dev, meta_WB, join_by(`Country Code`))

```

```{r}
# Databases Joining
Dev <-inner_join(Dev,GDI,join_by(`Country Code`))
Dev <-inner_join(Dev,HDI,join_by(`Country Code`))
Dev <-inner_join(Dev,Gini,join_by(`Country Code`))

# Final Dataset
dataset <- inner_join(Dev, PHDI, join_by(`Country Code`))

# Turn the Indicators from the World Bank Databases into Columns 
dataset<-dataset|>
  select(-`Series Code`)|>
  pivot_wider(names_from = `Series Name`,values_from = `2021 [YR2021]`)

# Elimination of all the NA Values 
dataset<-na.omit(dataset)

```

# Description of the research question (500 words)

# Graphical representation of the main variable (women in parliament)

## Distribution of the proportion of seats held by women in national parliaments (in percentage) ...

###... By Country

```{r}
dataset|>
  ggplot(aes(x=`Proportion of seats held by women in national parliaments (%)`)) +
           geom_histogram(bins=20)+
  geom_rug()

dataset|>
  ggplot(aes(x=`Proportion of seats held by women in national parliaments (%)`)) +
           geom_histogram(bins=20)+
  geom_rug()+
  facet_wrap(~Region)


dataset|>
  ggplot(aes(x=`Proportion of seats held by women in national parliaments (%)`)) +
           geom_histogram(bins=20)+
  geom_rug()+
  facet_wrap(~`Income Group`)


```
```{r}
dataset |>
  ggplot(aes(x = `Proportion of seats held by women in national parliaments (%)`)) +
  geom_density(fill = "orange") +
  labs(title = "Distribution of Proportion of Seats Held by Women in National Parliaments",
       x = "Proportion of Seats Held by Women (%)",
       y = "Density") 

dataset |>
  ggplot(aes(x = `Proportion of seats held by women in national parliaments (%)`)) +
  geom_density(fill = "orange") +
  labs(title = "Distribution of Proportion of Seats Held by Women in National Parliaments",
       x = "Proportion of Seats Held by Women (%)",
       y = "Density") +
  facet_wrap(~`Income Group`)

dataset |>
  ggplot(aes(x = `Proportion of seats held by women in national parliaments (%)`)) +
  geom_density(fill = "orange") +
  labs(title = "Distribution of Proportion of Seats Held by Women in National Parliaments",
       x = "Proportion of Seats Held by Women (%)",
       y = "Density") +
  facet_wrap(~`Region`)

```



### ... By Regions
```{r}
dataset |>
  group_by(Region) |>
  summarise("Average percentage of seats held by women in parliament" = mean(`Proportion of seats held by women in national parliaments (%)`)) |>
  ggplot(aes(x = Region, y = `Average percentage of seats held by women in parliament`, fill = Region)) +
  geom_col() +
  labs(title = "Average Proportion of Seats Held by Women in Parliament by Region (in %)",
       x = "Region",
       y = "Average Propotion (in %") 
```


###... By Income Group

```{r}
dataset |>
  group_by(`Income Group`) |>
  summarise("Average percentage of seats held by women in parliament" = mean(`Proportion of seats held by women in national parliaments (%)`)) |>
  ggplot(aes(x =`Income Group` , y = `Average percentage of seats held by women in parliament`, fill = `Income Group`)) +
  geom_col() +
  labs(title = "Average Proportion of Seats Held by Women in Parliament by Income Group (in %)",
       x = "Income Group",
       y = "Average Propotion (in %") 
```


